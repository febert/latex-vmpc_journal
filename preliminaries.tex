\section{Overview}\label{sec:prelim}
\label{sec:vmpc}
%%SL.10.15: change title to Overview?

%%SL.10.15: This is the wrong level of abstraction for this section. This section should provide a high-level overview of the structure of the method: data collection (how is that done?), model training, some considerations about the model (what is input and what is output?) and a brief summary of the test-time control method, not at the level of designated pixels yet, but maybe with a short summary of different ways to specify costs and some details about planning. I recommend starting with a high level motivation sentence or two, and then having \textbf{} paragraph headings for "Training data collection" "Model training" and "Test-time control", then briefly summarize what the following sections will be about, something like "In the next section, we will discuss the architectures and training procedures for our predictive models, followed by a discussion of planning objectives in Section~\ref{sec:something}, planning in Section~\ref{sec:something}, and system design considerations in Section~\ref{sec:something}." Here is an example for how you can open with the high level motivation: 
In this section, we summarize our visual model-predictive control (MPC) approach, which consists of a model-based reinforcement learning approach to end-to-end learning of robotic manipulation skills. Our method, outlined in figure \ref{fig:overview}, consists of three phases: unsupervised data collection, predictive model training, and planning-based control via the model at test-time.

\textbf{Unsupervised data collection}: At \emph{training time} data is collected fully autonomously by applying random actions.

\textbf{Model Training}: A video-prediction model is trained on the collected data offline. The video-prediction model takes as input an image of the current time-step and a sequence of actions and generates the corresponding sequence of future frames. 

\textbf{Test-time control}: At \emph{test time} we use a sampling-based planning approach similar to ``shooting methods`` to find the sequence of actions that minimizes a cost function, which is computed per time-step based on the predicted images and/or predicted probability distributions over pixel positions, which will be detailed in section \ref{sec:model}.
To render the planning process more efficient we use the cross-entropy method (CEM), a gradient-free optimization procedure. Further details can be found in section \ref{sec:optimizer}. The motivation for using a gradient-free, sampling-based optimizer is that in this way we can easily ensure that actions stay within the distribution of actions the model has encountered during training -- this is crucial to ensure that the model does not receive out-of-distribution inputs and makes valid predictions.
In order to correct for mistakes made by the model, the actions are iteratively replanned at each real-world time step $\tau \in \{0,...,\tau_{max}\}$ following the framework of model-predictive control (MPC): at each real-world step\footnote{With real-world step we mean timestep of the real-world as opposed to predicted timesteps.} $\tau$, the model is used to plan $T$ steps into the future, and the first action of the plan is executed.


% We assume that the user defines a goal in terms of pixel motion by clicking on the object in the image and a corresponding target location, or by providing one or several demonstrations. Designated pixel positions and demonstrations can also be combined. Based on either of these task definitions we define per-time step cost functions $c_t$ which are computed based on the results of the \emph{action-conditioned} video-prediction model. To find an action sequence $a_{t_0:T}$ for which $c = \sum^{T}_{t=t_0}{c_t}$ over the time steps is minimal we use sampling based planning: A large number of candidate action sequences is sampled and the model's predictions are evaluated using $c$. The first action of the sequence which achieved lowest cost is applied to the robot.






